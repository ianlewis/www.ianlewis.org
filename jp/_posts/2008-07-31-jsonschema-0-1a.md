---
layout: post
title: "jsonschema ヴァリデーター 0.1a"
date: 2008-07-31 15:29:07 +0000
permalink: /jp/jsonschema-0-1a
blog: jp
---

<p>昨日、<a href="http://tinyurl.com/32qd4v" title="JSONSchema">JSONSchema</a>　ヴァリデーターを漸くリリースしました。<a href="http://en.wikipedia.org/wiki/XML" title="XML">XML</a> Schema と同じような<a href="http://tinyurl.com/32qd4v" title="JSONSchema">JSONSchema</a>は　JSON文書の構造が正しいかどうかを検証するための文書。さらに、jsonschema ヴァリデーターはその<a href="http://tinyurl.com/32qd4v" title="JSONSchema">JSONSchema</a>文書に従ってJSON文書が正しいかどうかを検証する<a href="http://www.python.org/" title="Python">Python</a>モジュール。<a href="http://groups.google.com/group/json-schema/web/json-schema-proposal---second-draft">JSON Schema Proposal Second Draft</a>を基にしています。</p>
<p>ソースコードはこちらからダウンロードできます:<a href="http://jsonschema.googlecode.com/files/jsonschema-0.1a.tar.gz">jsonschema-0.1a.tar.gz</a><br /> ドキュメンテーションはこちら: <a href="http://hg.monologista.jp/json-schema/raw-file/41132f2b2b57/docs/jsonschema.html">jsonschema (version 0.1a) documentation</a> (<a href="http://hg.monologista.jp/json-schema/raw-file/41132f2b2b57/README.ja.utf8.txt">日本語 README</a>)</p>
<p><a href="http://tinyurl.com/32qd4v" title="JSONSchema">JSONSchema</a>はJSON文書の構造を検証するために作られている。JSON文書の構造、データ形式を定義することが出来る。例えば、連絡先のデータがあるとしましょう。</p>
<div class="codeblock amc_text amc_short"><table><tr class="amc_code_odd"><td class="amc_line"><div class="amc1"></div></td><td>{<br /></td></tr><tr class="amc_code_even"><td class="amc_line"><div class="amc2"></div></td><td>&nbsp; &quot;name&quot;: &quot;Ian Lewis&quot;,<br /></td></tr><tr class="amc_code_odd"><td class="amc_line"><div class="amc3"></div></td><td>&nbsp; &quot;email&quot;: &quot;IanLewis@xyz.com&quot;,<br /></td></tr><tr class="amc_code_even"><td class="amc_line"><div class="amc4"></div></td><td>&nbsp; &quot;address&quot;: &quot;123 Main St.&quot;,<br /></td></tr><tr class="amc_code_odd"><td class="amc_line"><div class="amc5"></div></td><td>&nbsp; &quot;phone&quot;: &quot;080-1942-9494&quot;<br /></td></tr><tr class="amc_code_even"><td class="amc_line"><div class="amc6"></div></td><td>}</td></tr></table></div>
<p>その文書を<a href="http://tinyurl.com/32qd4v" title="JSONSchema">JSONSchema</a>で定義すると、以下のようの<a href="http://tinyurl.com/32qd4v" title="JSONSchema">JSONSchema</a>が出る</p>
<div class="codeblock amc_javascript amc_short"><table><tr class="amc_code_odd"><td class="amc_line"><div class="amc1"></div></td><td><span style="color: #66cc66;">&#123;</span><br /></td></tr><tr class="amc_code_even"><td class="amc_line"><div class="amc2"></div></td><td>&nbsp; <span style="color: #3366CC;">&quot;type&quot;</span>:<span style="color: #3366CC;">&quot;object&quot;</span>,<br /></td></tr><tr class="amc_code_odd"><td class="amc_line"><div class="amc3"></div></td><td>&nbsp; <span style="color: #3366CC;">&quot;properties&quot;</span>:<span style="color: #66cc66;">&#123;</span><br /></td></tr><tr class="amc_code_even"><td class="amc_line"><div class="amc4"></div></td><td>&nbsp; &nbsp; <span style="color: #3366CC;">&quot;name&quot;</span>: <span style="color: #66cc66;">&#123;</span><span style="color: #3366CC;">&quot;type&quot;</span>:<span style="color: #3366CC;">&quot;string&quot;</span><span style="color: #66cc66;">&#125;</span>,<br /></td></tr><tr class="amc_code_odd"><td class="amc_line"><div class="amc5"></div></td><td>&nbsp; &nbsp; <span style="color: #3366CC;">&quot;age&quot;</span>: <span style="color: #66cc66;">&#123;</span><span style="color: #3366CC;">&quot;type&quot;</span>:<span style="color: #3366CC;">&quot;int&quot;</span>, <span style="color: #3366CC;">&quot;optional&quot;</span>:<span style="color: #003366; font-weight: bold;">True</span><span style="color: #66cc66;">&#125;</span>,<br /></td></tr><tr class="amc_code_even"><td class="amc_line"><div class="amc6"></div></td><td>&nbsp; &nbsp; <span style="color: #3366CC;">&quot;email&quot;</span>: <span style="color: #66cc66;">&#123;</span><br /></td></tr><tr class="amc_code_odd"><td class="amc_line"><div class="amc7"></div></td><td>&nbsp; &nbsp; &nbsp; <span style="color: #3366CC;">&quot;type&quot;</span>:<span style="color: #3366CC;">&quot;string&quot;</span>,<br /></td></tr><tr class="amc_code_even"><td class="amc_line"><div class="amc8"></div></td><td>&nbsp; &nbsp; &nbsp; <span style="color: #3366CC;">&quot;pattern&quot;</span>:<span style="color: #3366CC;">&quot;^[A-Za-z0-9][A-Za-z0-9<span style="color: #000099; font-weight: bold;">\.</span>]*@([A-Za-z0-9]+<span style="color: #000099; font-weight: bold;">\.</span>)+[A-Za-z0-9]+$&quot;</span><br /></td></tr><tr class="amc_code_odd"><td class="amc_line"><div class="amc9"></div></td><td>&nbsp; &nbsp; <span style="color: #66cc66;">&#125;</span>,<br /></td></tr><tr class="amc_code_even"><td class="amc_line"><div class="amc0"><div class="amc1"></div></div></td><td>&nbsp; &nbsp; <span style="color: #3366CC;">&quot;address&quot;</span>: <span style="color: #66cc66;">&#123;</span><span style="color: #3366CC;">&quot;type&quot;</span>:<span style="color: #3366CC;">&quot;string&quot;</span><span style="color: #66cc66;">&#125;</span>,<br /></td></tr><tr class="amc_code_odd"><td class="amc_line"><div class="amc1"><div class="amc1"></div></div></td><td>&nbsp; &nbsp; <span style="color: #3366CC;">&quot;phone&quot;</span>: <span style="color: #66cc66;">&#123;</span><span style="color: #3366CC;">&quot;type&quot;</span>:<span style="color: #3366CC;">&quot;string&quot;</span><span style="color: #66cc66;">&#125;</span><br /></td></tr><tr class="amc_code_even"><td class="amc_line"><div class="amc2"><div class="amc1"></div></div></td><td>&nbsp; <span style="color: #66cc66;">&#125;</span><br /></td></tr><tr class="amc_code_odd"><td class="amc_line"><div class="amc3"><div class="amc1"></div></div></td><td><span style="color: #66cc66;">&#125;</span></td></tr></table></div>
<p>さらに、以下の　<a href="http://www.python.org/" title="Python">Python</a> コードでこのJSON文書は当てるかどうかを検証するこどができる。</p>
<div class="codeblock amc_python amc_long"><table><tr class="amc_code_odd"><td class="amc_line"><div class="amc1"></div></td><td><span style="color: #ff7700;font-weight:bold;">import</span> jsonschema, simplejson<br /></td></tr><tr class="amc_code_even"><td class="amc_line"><div class="amc2"></div></td><td><br /></td></tr><tr class="amc_code_odd"><td class="amc_line"><div class="amc3"></div></td><td>data = <span style="color: #483d8b;">&quot;&quot;</span><span style="color: #483d8b;">&quot;{<br /></td></tr><tr class="amc_code_even"><td class="amc_line"><div class="amc4"></div></td><td>&nbsp; &quot;</span>name<span style="color: #483d8b;">&quot;: &quot;</span>Ian Lewis<span style="color: #483d8b;">&quot;,<br /></td></tr><tr class="amc_code_odd"><td class="amc_line"><div class="amc5"></div></td><td>&nbsp; &quot;</span><span style="color: #dc143c;">email</span><span style="color: #483d8b;">&quot;: &quot;</span>IanLewis@xyz.<span style="color: black;">com</span><span style="color: #483d8b;">&quot;,<br /></td></tr><tr class="amc_code_even"><td class="amc_line"><div class="amc6"></div></td><td>&nbsp; &quot;</span>address<span style="color: #483d8b;">&quot;: &quot;</span><span style="color: #ff4500;">123</span> Main St.<span style="color: #483d8b;">&quot;,<br /></td></tr><tr class="amc_code_odd"><td class="amc_line"><div class="amc7"></div></td><td>&nbsp; &quot;</span>phone<span style="color: #483d8b;">&quot;: &quot;</span><span style="color: #ff4500;">080</span><span style="color: #ff4500;">-1942</span><span style="color: #ff4500;">-9494</span><span style="color: #483d8b;">&quot;<br /></td></tr><tr class="amc_code_even"><td class="amc_line"><div class="amc8"></div></td><td>}&quot;</span><span style="color: #483d8b;">&quot;&quot;</span><br /></td></tr><tr class="amc_code_odd"><td class="amc_line"><div class="amc9"></div></td><td><br /></td></tr><tr class="amc_code_even"><td class="amc_line"><div class="amc0"><div class="amc1"></div></div></td><td>schema = <span style="color: #483d8b;">&quot;&quot;</span><span style="color: #483d8b;">&quot;{<br /></td></tr><tr class="amc_code_odd"><td class="amc_line"><div class="amc1"><div class="amc1"></div></div></td><td>&nbsp; &quot;</span><span style="color: #008000;">type</span><span style="color: #483d8b;">&quot;:&quot;</span><span style="color: #008000;">object</span><span style="color: #483d8b;">&quot;,<br /></td></tr><tr class="amc_code_even"><td class="amc_line"><div class="amc2"><div class="amc1"></div></div></td><td>&nbsp; &quot;</span>properties<span style="color: #483d8b;">&quot;:{<br /></td></tr><tr class="amc_code_odd"><td class="amc_line"><div class="amc3"><div class="amc1"></div></div></td><td>&nbsp; &nbsp; &quot;</span>name<span style="color: #483d8b;">&quot;: {&quot;</span><span style="color: #008000;">type</span><span style="color: #483d8b;">&quot;:&quot;</span><span style="color: #dc143c;">string</span><span style="color: #483d8b;">&quot;},<br /></td></tr><tr class="amc_code_even"><td class="amc_line"><div class="amc4"><div class="amc1"></div></div></td><td>&nbsp; &nbsp; &quot;</span>age<span style="color: #483d8b;">&quot;: {&quot;</span><span style="color: #008000;">type</span><span style="color: #483d8b;">&quot;:&quot;</span><span style="color: #008000;">int</span><span style="color: #483d8b;">&quot;, &quot;</span>optional<span style="color: #483d8b;">&quot;:True},<br /></td></tr><tr class="amc_code_odd"><td class="amc_line"><div class="amc5"><div class="amc1"></div></div></td><td>&nbsp; &nbsp; &quot;</span><span style="color: #dc143c;">email</span><span style="color: #483d8b;">&quot;: {<br /></td></tr><tr class="amc_code_even"><td class="amc_line"><div class="amc6"><div class="amc1"></div></div></td><td>&nbsp; &nbsp; &nbsp; &quot;</span><span style="color: #008000;">type</span><span style="color: #483d8b;">&quot;:&quot;</span><span style="color: #dc143c;">string</span><span style="color: #483d8b;">&quot;,<br /></td></tr><tr class="amc_code_odd"><td class="amc_line"><div class="amc7"><div class="amc1"></div></div></td><td>&nbsp; &nbsp; &nbsp; &quot;</span>pattern<span style="color: #483d8b;">&quot;:&quot;</span>^<span style="color: black;">&#91;</span>A-Za-z0<span style="color: #ff4500;">-9</span><span style="color: black;">&#93;</span><span style="color: black;">&#91;</span>A-Za-z0<span style="color: #ff4500;">-9</span>\.<span style="color: black;">&#93;</span><span style="color: #66cc66;">*</span>@<span style="color: black;">&#40;</span><span style="color: black;">&#91;</span>A-Za-z0<span style="color: #ff4500;">-9</span><span style="color: black;">&#93;</span>+\.<span style="color: black;">&#41;</span>+<span style="color: black;">&#91;</span>A-Za-z0<span style="color: #ff4500;">-9</span><span style="color: black;">&#93;</span>+$<span style="color: #483d8b;">&quot;<br /></td></tr><tr class="amc_code_even"><td class="amc_line"><div class="amc8"><div class="amc1"></div></div></td><td>&nbsp; &nbsp; },<br /></td></tr><tr class="amc_code_odd"><td class="amc_line"><div class="amc9"><div class="amc1"></div></div></td><td>&nbsp; &nbsp; &quot;</span>address<span style="color: #483d8b;">&quot;: {&quot;</span><span style="color: #008000;">type</span><span style="color: #483d8b;">&quot;:&quot;</span><span style="color: #dc143c;">string</span><span style="color: #483d8b;">&quot;},<br /></td></tr><tr class="amc_code_even"><td class="amc_line"><div class="amc0"><div class="amc2"></div></div></td><td>&nbsp; &nbsp; &quot;</span>phone<span style="color: #483d8b;">&quot;: {&quot;</span><span style="color: #008000;">type</span><span style="color: #483d8b;">&quot;:&quot;</span><span style="color: #dc143c;">string</span><span style="color: #483d8b;">&quot;}<br /></td></tr><tr class="amc_code_odd"><td class="amc_line"><div class="amc1"><div class="amc2"></div></div></td><td>&nbsp; }<br /></td></tr><tr class="amc_code_even"><td class="amc_line"><div class="amc2"><div class="amc2"></div></div></td><td>}&quot;</span><span style="color: #483d8b;">&quot;&quot;</span><br /></td></tr><tr class="amc_code_odd"><td class="amc_line"><div class="amc3"><div class="amc2"></div></div></td><td><br /></td></tr><tr class="amc_code_even"><td class="amc_line"><div class="amc4"><div class="amc2"></div></div></td><td>x = simplejson.<span style="color: black;">loads</span><span style="color: black;">&#40;</span>data<span style="color: black;">&#41;</span><br /></td></tr><tr class="amc_code_odd"><td class="amc_line"><div class="amc5"><div class="amc2"></div></div></td><td>s = simplesjson.<span style="color: black;">loads</span><span style="color: black;">&#40;</span>schema<span style="color: black;">&#41;</span><br /></td></tr><tr class="amc_code_even"><td class="amc_line"><div class="amc6"><div class="amc2"></div></div></td><td>jsonschema.<span style="color: black;">validate</span><span style="color: black;">&#40;</span>x,s<span style="color: black;">&#41;</span></td></tr></table></div>
<p><a href="http://tinyurl.com/32qd4v" title="JSONSchema">JSONSchema</a>に拡張プロパティを付けることや、デフォルト検証処理を変更することができるので、とても柔軟なモジュールだと思っています (自分が作ったことについて言えるかなぁ ^^; ) 。　僕自身は<a href="http://code.google.com/appengine/" title="Google App Engine">GAE</a>のプロジェクトで使うつもりだし、皆さんのご意見を是非聞かせてもらいたいと思います。</p>
