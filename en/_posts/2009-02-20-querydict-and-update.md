---
layout: post
title: "QueryDict and update()"
date: 2009-02-20 09:29:46 +0000
permalink: /en/querydict-and-update
blog: en
tags: python django
render_with_liquid: false
---

<p>Yesterday I ran into an interesting quirk with <a href="http://www.djangoproject.com/" title="Django">Django</a>'s QueryDict object and the normal dictionary update() method. Normally the update method will allow you to merge two dictionary or dictionary like objects but because the QueryDict internally holds it's values as lists you get some unexpected behavior.</p>

<p>For instance with a normal dictionary you can do this:</p>

<div class="codeblock amc_python amc_short"><table><tr class="amc_code_odd"><td class="amc_line"><div class="amc1"></div></td><td><span style="color: #66cc66;">&gt;&gt;</span> x = <span style="color: black;">&#123;</span><span style="color: #483d8b;">&quot;name&quot;</span>: <span style="color: #483d8b;">&quot;Ian&quot;</span><span style="color: black;">&#125;</span><br /></td></tr><tr class="amc_code_even"><td class="amc_line"><div class="amc2"></div></td><td><span style="color: #66cc66;">&gt;&gt;</span> x.<span style="color: black;">update</span><span style="color: black;">&#40;</span><span style="color: black;">&#123;</span><span style="color: #483d8b;">&quot;age&quot;</span>:<span style="color: #ff4500;">27</span><span style="color: black;">&#125;</span><span style="color: black;">&#41;</span><br /></td></tr><tr class="amc_code_odd"><td class="amc_line"><div class="amc3"></div></td><td><span style="color: #66cc66;">&gt;&gt;</span> x<br /></td></tr><tr class="amc_code_even"><td class="amc_line"><div class="amc4"></div></td><td><span style="color: black;">&#123;</span><span style="color: #483d8b;">'age'</span>: <span style="color: #ff4500;">27</span>, <span style="color: #483d8b;">'name'</span>: <span style="color: #483d8b;">'Ian'</span><span style="color: black;">&#125;</span></td></tr></table></div>

<p>But with <a href="http://www.djangoproject.com/" title="Django">Django</a>'s request.POST and request.GET QueryDict objects the internal representation of the values are list so you get unexpected behavior even though normally accessing the value by key does not give you a list:</p>

<div class="codeblock amc_python amc_short"><table><tr class="amc_code_odd"><td class="amc_line"><div class="amc1"></div></td><td><span style="color: #66cc66;">&gt;&gt;</span> x = <span style="color: black;">&#123;</span><span style="color: #483d8b;">&quot;job&quot;</span>:<span style="color: #483d8b;">&quot;programmer&quot;</span><span style="color: black;">&#125;</span><br /></td></tr><tr class="amc_code_even"><td class="amc_line"><div class="amc2"></div></td><td><span style="color: #66cc66;">&gt;&gt;</span> request.<span style="color: black;">POST</span><br /></td></tr><tr class="amc_code_odd"><td class="amc_line"><div class="amc3"></div></td><td><span style="color: #66cc66;">&lt;</span>QueryDict: <span style="color: black;">&#123;</span>u<span style="color: #483d8b;">'name'</span>: <span style="color: black;">&#91;</span>u<span style="color: #483d8b;">'Ian'</span><span style="color: black;">&#93;</span>, u<span style="color: #483d8b;">'age'</span>: <span style="color: black;">&#91;</span>u<span style="color: #483d8b;">'27'</span><span style="color: black;">&#93;</span><span style="color: black;">&#125;</span><span style="color: #66cc66;">&gt;</span><br /></td></tr><tr class="amc_code_even"><td class="amc_line"><div class="amc4"></div></td><td><span style="color: #66cc66;">&gt;&gt;</span> request.<span style="color: black;">POST</span><span style="color: black;">&#91;</span><span style="color: #483d8b;">'name'</span><span style="color: black;">&#93;</span><br /></td></tr><tr class="amc_code_odd"><td class="amc_line"><div class="amc5"></div></td><td>u<span style="color: #483d8b;">'Ian'</span><br /></td></tr><tr class="amc_code_even"><td class="amc_line"><div class="amc6"></div></td><td><span style="color: #66cc66;">&gt;&gt;</span> request.<span style="color: black;">POST</span><span style="color: black;">&#91;</span><span style="color: #483d8b;">'age'</span><span style="color: black;">&#93;</span><br /></td></tr><tr class="amc_code_odd"><td class="amc_line"><div class="amc7"></div></td><td>u<span style="color: #483d8b;">'27'</span><br /></td></tr><tr class="amc_code_even"><td class="amc_line"><div class="amc8"></div></td><td><span style="color: #66cc66;">&gt;&gt;</span> x.<span style="color: black;">update</span><span style="color: black;">&#40;</span>request.<span style="color: black;">POST</span><span style="color: black;">&#41;</span><br /></td></tr><tr class="amc_code_odd"><td class="amc_line"><div class="amc9"></div></td><td><span style="color: #66cc66;">&gt;&gt;</span> x<br /></td></tr><tr class="amc_code_even"><td class="amc_line"><div class="amc0"><div class="amc1"></div></div></td><td><span style="color: black;">&#123;</span>u<span style="color: #483d8b;">'name'</span>: <span style="color: black;">&#91;</span>u<span style="color: #483d8b;">'Ian'</span><span style="color: black;">&#93;</span>, u<span style="color: #483d8b;">'age'</span>: <span style="color: black;">&#91;</span>u<span style="color: #483d8b;">'27'</span><span style="color: black;">&#93;</span>, <span style="color: #483d8b;">'job'</span>: <span style="color: #483d8b;">'programmer'</span><span style="color: black;">&#125;</span><br /></td></tr><tr class="amc_code_odd"><td class="amc_line"><div class="amc1"><div class="amc1"></div></div></td><td><span style="color: #66cc66;">&gt;&gt;</span> x<span style="color: black;">&#91;</span><span style="color: #483d8b;">'name'</span><span style="color: black;">&#93;</span><br /></td></tr><tr class="amc_code_even"><td class="amc_line"><div class="amc2"><div class="amc1"></div></div></td><td><span style="color: black;">&#91;</span>u<span style="color: #483d8b;">'Ian'</span><span style="color: black;">&#93;</span><br /></td></tr><tr class="amc_code_odd"><td class="amc_line"><div class="amc3"><div class="amc1"></div></div></td><td><span style="color: #66cc66;">&gt;&gt;</span> x<span style="color: black;">&#91;</span><span style="color: #483d8b;">'age'</span><span style="color: black;">&#93;</span><br /></td></tr><tr class="amc_code_even"><td class="amc_line"><div class="amc4"><div class="amc1"></div></div></td><td><span style="color: black;">&#91;</span>u<span style="color: #483d8b;">'27'</span><span style="color: black;">&#93;</span></td></tr></table></div>
